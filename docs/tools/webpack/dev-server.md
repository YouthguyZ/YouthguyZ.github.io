---
sidebarDepth: 3
---

# DevServer

åœ¨å¼€å‘è¿‡ç¨‹ä¸­ï¼Œåˆ©ç”¨åˆç†çš„ `devServer` é…ç½®ï¼Œå¯ä»¥æœ‰æ•ˆçš„æé«˜æˆ‘ä»¬çš„å·¥ä½œæ•ˆç‡ã€‚æœ¬èŠ‚æˆ‘ä»¬å°±æ¥çœ‹çœ‹å¦‚æœå¯¹ `devServer` è¿›è¡Œé…ç½®ã€‚

## å®‰è£…

åœ¨ä»‹ç»å…·ä½“å†…å®¹ä¹‹å‰ï¼Œä½ éœ€è¦å…ˆå®‰è£…è¿™ä¸ªåŒ…ï¼š

```
npm install webpack-dev-server
```

æ¥ç€é…ç½®ä¸€ä¸ª npm script å³å¯ï¼š

```json
{
  "scripts": {
    "dev": "webpack-dev-server"
  }
}
```

æœ€åæ‰§è¡Œ `npm run dev`ï¼Œä½ çš„åº”ç”¨å°±æˆåŠŸçš„è¿è¡Œåœ¨è¿™ä¸ªå¼€å‘æœåŠ¡å™¨ä¸Šäº†ã€‚è¿™æ—¶å€™å¦‚æœä½ æ²¡æœ‰åœ¨ webpack é…ç½®æ–‡ä»¶ä¸­é…ç½® devServer å±æ€§çš„è¯ï¼Œä¼šé‡‡ç”¨å®ƒçš„é»˜è®¤é…ç½®ï¼Œæ¯”å¦‚é»˜è®¤ç«¯å£æ˜¯ 8080 ç­‰ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬ç»†è¯´å®ƒçš„å„é¡¹é…ç½®ã€‚

## é…ç½®

### port ğŸ”‘

æœåŠ¡å™¨è¿è¡Œçš„ç«¯å£å·ï¼Œé»˜è®¤ 8080ã€‚


### open ğŸ”‘

æ˜¯å¦è‡ªåŠ¨çš„æ‰“å¼€æµè§ˆå™¨ã€‚è®¾ç½®ä¸º true çš„è¯ï¼Œä¼šè‡ªåŠ¨çš„æ‰“å¼€ä½ çš„**é»˜è®¤æµè§ˆå™¨**ã€‚

å¦‚æœä½ æƒ³æ‰“å¼€æŒ‡å®šæµè§ˆå™¨çš„è¯ï¼Œæ¯”å¦‚ä½ åœ¨ Mac OS ä¸Šæƒ³é»˜è®¤æ‰“å¼€ Firefoxï¼Œä½ å¯ä»¥è®¾ç½®ï¼š

```js
devServer: {
  open: 'Firefox'
}
```

:::tip
æ³¨æ„ï¼Œè¿™é‡Œçš„æµè§ˆå™¨åç§°éœ€è¦æ˜¯ä½ æœ¬åœ° app çš„åç§°ï¼Œæ¯”å¦‚è°·æ­Œæµè§ˆå™¨åœ¨ Mac ä¸Šå«åš Google Chromeï¼Œåœ¨ Windows ä¸Šå«åš chromeã€‚
:::

åœ¨ **webpack V5** ä¸­ï¼Œä½ ä¹Ÿå¯ä»¥æŒ‡å®š open å±æ€§ä¸ºä¸€ä¸ªå¯¹è±¡ï¼Œå®ƒçš„é…ç½®å’Œ [open](https://www.npmjs.com/package/open) ä¸€æ ·ï¼Œæ¯”å¦‚æˆ‘è¦é…ç½®é»˜è®¤æ‰“å¼€ Chrome æµè§ˆå™¨ï¼Œå¹¶ä¸”å¼€å¯éšç§æ¨¡å¼ï¼Œä½ å¯ä»¥è¿™ä¹ˆè®¾ç½®ï¼š

```js
devServer: {
  open: {
    app: ['Google Chrome', '--incognito']
  }
}
```

### openPage

å½“æ‰“å¼€æµè§ˆå™¨çš„æ—¶å€™ï¼ŒæŒ‡å®šè¦æ‰“å¼€çš„é¡µé¢ã€‚å®ƒå¯ä»¥æ˜¯å­—ç¬¦ä¸²ç±»å‹çš„ï¼Œä¹Ÿå¯ä»¥æ˜¯æ•°ç»„ï¼Œè¡¨ç¤ºè¦æ‰“å¼€ä¸€ç»„é¡µé¢ã€‚

```js
devServer: {
  openPage: 'index.html',
  // openPage: ['index.html', 'login.html'],
}
```

### compress

å¯ç”¨ gizp å‹ç¼©ã€‚å®ƒæ˜¯ä¸€ä¸ªå¸ƒå°”å€¼ã€‚

```js
devServer: {
  compress: true
}
```

å½“ä½ è®¾ç½®ä¸º true æ—¶ï¼Œå“åº”å¤´ä¼šå¤šå‡ºå¦‚ä¸‹å­—æ®µï¼š
```
Content-Encoding: gzip
```
  
### writeToDisk

æ˜¯å¦å°†æ‰“åŒ…ç”Ÿæˆçš„æ–‡ä»¶å†™å…¥åˆ°ç¡¬ç›˜ä¸­ã€‚æˆ‘ä»¬çŸ¥é“ï¼Œå¼€å‘æœåŠ¡å™¨ä¸‹çš„ç”Ÿæˆæ–‡ä»¶æ˜¯åœ¨å†…å­˜ä¸­çš„ï¼Œå¦‚æœä½ æƒ³åœ¨æœ¬åœ°çœ‹åˆ°å¼€å‘ç¯å¢ƒä¸‹æ‰“åŒ…ç”Ÿæˆçš„æ–‡ä»¶æ˜¯å•¥æ ·çš„ï¼Œå¯ä»¥å°†å®ƒè®¾ç½®ä¸º trueã€‚

```js
devServer: {
  writeToDisk: true
}
```

**å®ƒä¼šå°†ç”Ÿæˆçš„æ–‡ä»¶æ”¾åœ¨ output.path ä¸­é…ç½®çš„è·¯å¾„ä¸­**ã€‚å®ƒçš„å€¼ä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå‡½æ•°æ¥æ”¶ä¸€ä¸ªæ–‡ä»¶è·¯å¾„ä½œä¸ºå‚æ•°ï¼Œè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼æ¥å†³å®šè¿™ä¸ªæ–‡ä»¶è¦ä¸è¦å†™è¿›ç¡¬ç›˜ï¼Œä¾‹å¦‚ä¸‹é¢çš„é…ç½®ï¼Œå°±åªå°† js æ–‡ä»¶å†™è¿›ç¡¬ç›˜ä¸­ï¼š

```js
devServer: {
  writeToDisk: (filePath) => {
    return /\.js$/.test(filePath)
  }
}
```

### onListening

å½“ webpack-dev-server å¼€å§‹ç›‘å¬ç«¯å£ä¸Šçš„è¿æ¥æ—¶ï¼Œè¦æ‰§è¡Œçš„æ“ä½œã€‚ä»–æ˜¯ä¸€ä¸ªå‡½æ•°ã€‚

```js
devServer: {
  onListening: function(server) {
    const port = server.listeningApp.address().port;
    console.log('Listening on port:', port);
  }
}
```

### before ğŸ”‘

å®ƒæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œåœ¨ webpack-dev-server æ‰€æœ‰çš„å†…ç½®ä¸­é—´ä»¶æ‰§è¡Œå‰æ‰§è¡Œã€‚æˆ‘ä»¬å¯ä»¥åœ¨å‡½æ•°ä¸­åšå¾ˆå¤šæœ‰æ„æ€çš„äº‹ï¼Œæ¯”å¦‚æ•°æ® mockç­‰ã€‚

```js
before(app) {
  app.get('/api/user/1', function(req, res) {
    res.json({ name: 'Jerry' });
  });
}
```

ä¸Šé¢çš„ä»£ç ï¼Œç›¸å½“äº mock äº†ä¸€ä¸ª `/api/user/1` çš„æ¥å£ï¼Œå®ƒè¿”å›ä¸€ä¸ª json å¯¹è±¡ã€‚ä½ å¯ä»¥åœ¨ä½ çš„ä¸šåŠ¡ä»£ç ä¸­è°ƒç”¨è¿™ä¸ªæ¥å£ï¼Œä¾‹å¦‚é€šè¿‡ axios è¯·æ±‚ï¼š

```js
axios.get('/api/user/1').then(res => {
  // handle res
})
```


### after

å®ƒä¹Ÿæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œåœ¨ dev-server å†…éƒ¨ä¸­é—´ä»¶æ‰§è¡Œå®Œä¹‹åæ‰§è¡Œã€‚ä½ ä¹Ÿå¯ä»¥åœ¨è¿™é‡Œè¿›è¡Œæ•°æ® mockï¼Œè¿™é‡Œå°±ä¸å¤šè§£é‡Šäº†ã€‚å®ƒå’Œ before ç›¸å½“äºä¸¤ä¸ªé’©å­ï¼Œä¸€ä¸ªåœ¨ dev-server æ‰€æœ‰å†…ç½®ä¸­é—´ä»¶æ‰§è¡Œå‰æ‰§è¡Œï¼Œä¸€ä¸ªåœ¨ dev-server æ‰€æœ‰å†…ç½®ä¸­é—´ä»¶æ‰§è¡Œä¹‹åæ‰§è¡Œã€‚


### clientLogLevel

è®¾ç½®ä½  DevTool ä¸Šæ§åˆ¶å°çš„æ—¥å¿—çº§åˆ«ã€‚æˆ‘ä»¬åœ¨æµè§ˆå™¨çš„æ§åˆ¶å°ä¸Šï¼Œç»å¸¸ä¼šçœ‹åˆ°ä¸€äº›æ—¥å¿—ä¿¡æ¯æˆ–è€…ä¸€äº›ç¼–è¯‘è­¦å‘Šæˆ–è€…é”™è¯¯ä¿¡æ¯ï¼Œæ¯”å¦‚ï¼š

```
[WDS] App updated. Recompiling...
[WDS] App hot update...
[HMR] Checking for updates on the server...
[HMR] Nothing hot updated.
[HMR] App is up to date.
```

ä½ å¯ä»¥é€šè¿‡è®¾ç½®ä¸åŒçš„çº§åˆ«æ¥é™åˆ¶æ§åˆ¶å°çš„è¾“å‡ºï¼š

```js
devServer: {
  clientLogLevel: 'error' // åªæ˜¾ç¤ºé”™è¯¯ä¿¡æ¯
}
```

ç±»ä¼¼çš„çº§åˆ«è¿˜æœ‰ infoï¼Œdebugï¼Œwarn ç­‰ã€‚**å¦‚æœä½ å«Œæ—¥å¿—å¤ªå¤šå¾ˆçƒ¦ï¼Œé‚£ä¹ˆå¯ä»¥è®¾ç½®ä¸º `silent` æ¥å…³æ‰æ—¥å¿—ï¼ˆä½†æ˜¯é”™è¯¯ä¿¡æ¯è¿˜æ˜¯ä¼šå±•ç¤ºï¼‰ã€‚**

### overlay

å½“ **ç¼–è¯‘æŠ¥è­¦å‘Šæˆ–è€…å‡ºé”™** çš„æ—¶å€™ï¼Œæ˜¯å¦åœ¨æµè§ˆå™¨ä¸Šæ˜¾ç¤ºä¸€ä¸ªå…¨å±çš„é®å±‚æ¥å±•ç¤ºè¿™äº›ä¿¡æ¯ã€‚æ³¨æ„è¿™é‡Œæ˜¾ç¤ºçš„ç¼–è¯‘ç›¸å…³çš„ä¿¡æ¯ï¼Œæ¯”å¦‚ä½ çš„ä»£ç ä¸ç¬¦åˆæŸä¸ª eslint æ ‡å‡†ï¼Œæˆ–è€…ä»£ç å°‘ä¸ªæ‹¬å·ç­‰ä¼šå¼•èµ·ç¼–è¯‘å‡ºé”™çš„æ—¶å€™ã€‚æ¯”å¦‚å¦‚ä¸‹ä»£ç ï¼š

```js
console.info('hello'
```

ä¼šæŠ¥é”™ï¼š

![compile error](../images/compile_error.png)

å½“è®¾ç½®ä¸º true çš„æ—¶å€™ï¼Œåªä¼šæ˜¾ç¤ºé”™è¯¯ä¿¡æ¯ã€‚å¦‚æœä½ æƒ³æ˜¾ç¤ºè­¦å‘Šä¿¡æ¯å’Œé”™è¯¯ä¿¡æ¯çš„è¯ï¼Œå¯ä»¥è®¾ç½®æˆä¸€ä¸ªå¯¹è±¡ï¼š

```js
devServer: {
  overlay: {
    warnings: true,
    errors: true
  }
}
```

### quiet

æˆ‘ä»¬çŸ¥é“ï¼Œå½“è¿è¡Œ `npm run dev` æ—¶ï¼Œå‘½ä»¤è¡Œä¼šæ‰“å°å‡ºå¾ˆå¤šæ—¥å¿—ï¼š

![console info](../images/console_info.png)


ä½ å¯ä»¥é€šè¿‡è®¾ç½® quiet ä¸º true æ¥ç¦ç”¨æ‰æ—¥å¿—ã€‚**æ³¨æ„ï¼Œæ­¤æ—¶è­¦å‘Šå’Œé”™è¯¯ä¿¡æ¯ä¹Ÿä¸ä¼šæ˜¾ç¤ºäº†ï¼Œæ‰€ä»¥è¿™ä¸ªå±æ€§è¿˜æ˜¯æ…ç”¨ã€‚**

```js
devServer: {
  quiet: true
}
```

![console quiet](../images/console_quiet.png)


### noInfo 

å®ƒä¹Ÿæ˜¯ä¸€ä¸ªæ—¥å¿—è¾“å‡ºçš„æ§åˆ¶ã€‚noInfo çš„ä½œç”¨æ˜¯ä¸è¾“å‡º webpack çš„æ‰“åŒ…ä¿¡æ¯ï¼Œä½†æ˜¯å¯¹äºé”™è¯¯å’Œè­¦å‘Šè¿˜æ˜¯ä¼šè¾“å‡ºçš„ã€‚å…³äºå®ƒå’Œ quiet çš„ä¼˜å…ˆçº§ï¼Œè¯»è€…å¯ä»¥è‡ªè¡Œå°è¯•ä¸€ä¸‹ã€‚

```js
devServer: {
  noInfo: true
}
```
![console info noinfo](../images/console_noinfo.png)


### stats

**è¿™ä¸ªé€‰é¡¹å¯ä»¥è®©ä½ ç²¾ç¡®åœ°æ§åˆ¶æ˜¾ç¤ºä»€ä¹ˆ bundle ä¿¡æ¯ï¼Œå®ƒæ˜¯ç”¨æ¥æ§åˆ¶ bundle ä¿¡æ¯çš„æ˜¾ç¤ºçš„ã€‚** å¦‚æœä½ ä¸æƒ³ä½¿ç”¨ noInfo å’Œ quiet æ¥é…ç½®çš„è¯ï¼Œè¿™ä¹Ÿæ˜¯ä¸€ä¸ªä¸é”™çš„é€‰æ‹©ã€‚ä½ å¯ä»¥å‚è€ƒ [stats](https://webpack.js.org/configuration/stats/) é…ç½®æ¥æ›´è¿›ä¸€æ­¥çš„äº†è§£ã€‚æ¯”å¦‚ä½ åªæƒ³çœ‹åˆ° bundle çš„é”™è¯¯ä¿¡æ¯ï¼Œé‚£ä¹ˆå¯ä»¥é…ç½®ï¼š

```js
devServer: {
  stats: 'errors-only'
}
```

**æ³¨æ„ï¼Œå®ƒåœ¨ä¸ quiet æˆ– noInfo ä¸€èµ·ä½¿ç”¨æ—¶ä¸èµ·ä½œç”¨ã€‚**

### inline ğŸ”‘

inline = true, inline æ¨¡å¼ï¼›inline = falseï¼Œiframe æ¨¡å¼ã€‚

**devServer çš„å®æ—¶é¢„è§ˆåŠŸèƒ½ï¼Œå®é™…ä¸Šä¾é çš„æ˜¯ä¸€ä¸ªæ³¨å…¥è¿›é¡µé¢çš„ä»£ç†å®¢æˆ·ç«¯ä¸ devServer ä¹‹é—´çš„é€šä¿¡æ¥å®ç°çš„ã€‚å¦‚æœä½ å¼€å¯äº† inline æ¨¡å¼ï¼Œè¿™ä¸ªè„šæœ¬å°±ä¼šæ³¨å…¥è¿›ä½ çš„ bundle æ¥è´Ÿè´£ä¸ devServer é€šä¿¡ï¼Œæ„å»ºä¿¡æ¯ä¹Ÿä¼šå®æ—¶çš„æ˜¾ç¤ºåœ¨æµè§ˆå™¨æ§åˆ¶å°ä¸Šã€‚**


ç›¸åçš„ï¼Œå¦‚æœä½ è®¾ç½®æˆ falseï¼Œé‚£ä¹ˆ devServer å°†æ— æ³•ç›´æ¥æ§åˆ¶ä½ æ­£åœ¨å¼€å‘çš„ç½‘é¡µï¼Œè¿™æ—¶å€™å®ƒä¼šåœ¨ä½ çš„é¡µé¢ä¸ŠåŠ ä¸€ä¸ª iframeï¼Œé€šè¿‡ iframe çš„åˆ·æ–°æ¥å®ç°å®æ—¶é¢„è§ˆçš„æ•ˆæœã€‚ä¸è¿‡è¿™æ—¶å€™ä½ è¦é€šè¿‡ http://localhost:8080/webpack-dev-server/ å»è®¿é—®ä½ çš„åº”ç”¨ã€‚

![inline](../images/inline.png)


**æ¨èé‡‡ç”¨é»˜è®¤å€¼ï¼Œå³ä½¿ç”¨ inline æ¨¡å¼æ¥å®æ—¶é¢„è§ˆã€‚**


### public

ä¸€èˆ¬ç”¨ä¸åˆ°ã€‚ä½†æ˜¯å¦‚æœä½ çš„æœ¬åœ°å¼€å¯äº†ä»£ç†ï¼Œå°†ä½ çš„æœåŠ¡è½¬å‘äº†å¦ä¸€ä¸ªåœ°å€ï¼Œé‚£ä¹ˆè¿™ä¸ªé…ç½®é¡¹å°±èµ·ä½œç”¨äº†ã€‚æ¯”å¦‚ï¼š

```js
devServer: {
  public: 'mysite.com:9999'
}
```

é»˜è®¤æ‰“å¼€çš„åœ°å€å°±æ˜¯ mysite.com:9999 äº†ã€‚

![public](../images/public.png)


### publicPath ğŸ”‘

è¿™ä¸ªæ˜¯ç”¨æ¥é…ç½®ä½ æ‰“åŒ…åçš„æ–‡ä»¶è·¯å¾„çš„ã€‚æ¯”å¦‚ä½ çš„æœåŠ¡å™¨è¿è¡Œåœ¨ http://localhost:8080 ä¸Šï¼Œç„¶å `output.filename` è®¾ç½®ä¸º bundle.jsã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œ`devServer.publicPath` ä¸º '/'ï¼Œæ‰€ä»¥ä½ å¯ä»¥é€šè¿‡ http://localhost:8080/bundle.js æ¥è®¿é—®ä½ æ‰“åŒ…åçš„æ–‡ä»¶ã€‚

ä½ ä¹Ÿå¯ä»¥è‡ªå·±è®¾ç½®å…·ä½“çš„è·¯å¾„ï¼š

```js
devServer: {
  publicPath: '/assets/'
  // publicPath: ''
}
```

å¯ä»¥çœ‹ä¸€ä¸‹æ—¥å¿—ï¼š

![public path](../images/public_path.png)

è¿™æ—¶å€™ä½ åº”è¯¥é€šè¿‡ http://localhost:8080/assets/index.html æ¥è®¿é—®é¡µé¢ï¼Œä½ çš„ bundle.js æ–‡ä»¶ä¹Ÿæ˜¯åœ¨ http://localhost:8080/assets/ è¿™ä¸ªç›®å½•ä¸‹ã€‚

æˆ‘ä»¬å¯ä»¥å°† public å’Œ publicPath ç»“åˆèµ·æ¥é…ç½®ï¼Œä¾‹å¦‚ï¼š

```js
devServer: {
  port: 8888,
  public: 'localhost:8888/assets',
  publicPath: '/assets/'
}
```

![public and public path](../images/public_and_path.png)


æœ‰ä¸¤ç‚¹éœ€è¦æ³¨æ„ä¸€ä¸‹ï¼š

1. publicPath çš„å€¼æ°¸è¿œè¦ä»¥ / å¼€å¤´ï¼Œä»¥ / ç»“å°¾
2. **publicPath çš„å€¼æœ€å¥½å’Œ output.path ä¿æŒä¸€è‡´**


### https

è®¾ç½®ä¸º true è¡¨ç¤ºå¼€å¯ httpsã€‚ä½ ä¹Ÿå¯ä»¥æŒ‡å®šè‡ªå·±çš„è¯ä¹¦ï¼š

```js
devServer: {
  https: true,
  key: fs.readFileSync('/path/to/server.key'),
  cert: fs.readFileSync('/path/to/server.crt'),
  ca: fs.readFileSync('/path/to/ca.pem'),
}
```

### http2

å®ƒæ˜¯ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæ˜¯å¦å¼€å¯ http2 ä¼ è¾“ï¼ˆåŸºäºspdyï¼‰ã€‚**è¿™ä¸ªå±æ€§åœ¨ node v10+ ä¸Šæ— æ•ˆã€‚**

### index

æ‰“å¼€çš„ index æ–‡ä»¶çš„åç§°ã€‚é»˜è®¤æ˜¯ index.htmlã€‚å½“ä½ é»˜è®¤çš„æ–‡ä»¶åä¸æ˜¯ index.html çš„æ—¶å€™ï¼ŒæŒ‡å®šå®ƒä¼šå¾ˆæœ‰ç”¨ï¼Œæ¯”å¦‚ç»“åˆ HtmlWebpackPlugin æ¥é…ç½®ï¼š

```js
{
  plugins: [
    new HtmlWebpackPlugin({
      title: 'DevServer Test',
      filename: 'hello.html'
    })
  ],
  devServer: {
    index: 'hello.html'
  }
}
```

è¿™æ ·çš„é…ç½®èƒ½ä¿è¯æˆ‘ä»¬æ­£ç¡®çš„æ‰“å¼€ index æ–‡ä»¶ã€‚


### allowedHosts

é…ç½®å“ªäº›ä¸»æœºè®¿é—®æˆ‘ä»¬çš„æœåŠ¡ã€‚

```js
devServer: {
  allowedHosts: [
    'baidu.com',
    '.hello.com'
  ]
}
```

### disableHostCheck

è®¾ç½®ä¸º true çš„è¯è¡¨ç¤ºç¦ç”¨ä¸»æœºæ£€æŸ¥ï¼Œè¿™æ—¶å€™ä½ å¯ä»¥æ¥æ”¶æ¥è‡ªä»»æ„ä¸»æœºçš„è¯·æ±‚ã€‚**éå¸¸ä¸æ¨èè®¾ç½®ä¸º trueï¼Œå› ä¸ºè¿™å®¹æ˜“è®©ä½ æ”¶åˆ° DNS é‡ç»‘å®šæ”»å‡»ã€‚**

### host ğŸ”‘

æŒ‡å®šè¦ä½¿ç”¨çš„ä¸»æœºã€‚

è¿™ä¸ªé…ç½®éå¸¸æœ‰ç”¨ï¼Œé¡¹ç›®å¼€å‘çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¸¸å¸¸é‡åˆ°è¿™æ ·çš„æƒ…å†µï¼Œä½ æœ¬åœ°æ”¹äº†ä¸€ä¸ªä¸œè¥¿ï¼Œè¿˜æ²¡ä¸Šæµ‹è¯•ç¯å¢ƒï¼Œæƒ³è®©åˆ«äººå…ˆçœ‹çœ‹æ•ˆæœï¼Œä½ å°±éœ€è¦åˆ«äººè®¿é—®ä½ ç”µè„‘ä¸Šè¿è¡Œçš„åº”ç”¨ï¼Œè¿™æ—¶ä½ éœ€è¦é…ç½®ï¼š

```js
devServer: {
  host: '0.0.0.0'
}
```

ä½ å°†ä½ çš„ ip å‘ç»™ä½ çš„åŒäº‹ï¼Œå®ƒå°±å¯ä»¥é€šè¿‡ ip:port/path/to/app æ¥è®¿é—®ä½ ç”µè„‘ä¸Šçš„æœåŠ¡äº†ã€‚è¿™æ—¶å€™ä½ çš„ disableHostCheck éœ€è¦è®¾ç½®ä¸º trueï¼Œå› ä¸ºåˆ«äººæ˜¯é€šè¿‡ä½ çš„ ip æ¥è®¿é—®çš„ã€‚

### useLocalIp

æ˜¯å¦ä½¿ç”¨æœ¬åœ° ip æ‰“å¼€æµè§ˆå™¨ã€‚é»˜è®¤æ˜¯ falseã€‚

è¦æƒ³è¿™ä¸ªå±æ€§èµ·ä½œç”¨ï¼Œä½ çš„ host å±æ€§è¦ä¹ˆæ˜¯æœ¬åœ°çš„ ipï¼Œè¦ä¹ˆæ˜¯ 0.0.0.0ã€‚è¿™ä¸ªå±æ€§å¾ˆå°‘ç”¨åˆ°ï¼Œå®åœ¨è¦é…ç½®çš„è¯ï¼Œå‚è€ƒå¦‚ä¸‹ï¼š

```js
devServer: {
  host: '0.0.0.0',
  useLocalIp: true
}
```

### hot ğŸ”‘

å¼€å¯çƒ­æ¨¡å—æ›´æ–°ï¼ˆHMRï¼‰

### hotOnly ğŸ”‘

å½“æ„å»ºå¤±è´¥çš„æ—¶å€™ï¼Œä¹Ÿä¸è¦åˆ·æ–°æµè§ˆå™¨ï¼Œä¾æ—§ä½¿ç”¨ HMRã€‚é€šå¸¸æˆ‘ä»¬ä¸€èµ·è®¾ç½®ï¼š

```js
devServer: {
  hot: true,
  hotOnly: true
}
```

### contentBase ğŸ”‘

æˆ‘ä»¬çŸ¥é“ï¼ŒdevServer é€šè¿‡ HTTP æœåŠ¡æš´éœ²å‡ºæ¥çš„æ–‡ä»¶åˆ†ä¸ºä¸¤ç±»ã€‚ä¸€ç±»æ˜¯ webpack æ‰“åŒ…å‡ºçš„æ–‡ä»¶ï¼Œä¸€ç±»æ˜¯æœ¬åœ°çš„é™æ€æ–‡ä»¶ã€‚å‰è€…æˆ‘ä»¬å¯ä»¥é€šè¿‡ publicPath æ¥æŒ‡å®šæœåŠ¡çš„åœ°å€ï¼Œåè€…å°±è¦é æˆ‘ä»¬çš„ contentBase æ¥æŒ‡å®šäº†ã€‚æ¯”å¦‚ï¼š

```js
devServer: {
  contentBase: path.join(__dirname, 'public')
}
```

è¿™å°±æŠŠé¡¹ç›®æ ¹ç›®å½•ä¸‹çš„ public æ–‡ä»¶å¤¹ä½œä¸ºæœåŠ¡æ–‡ä»¶çš„è·¯å¾„äº†ã€‚å¦‚æœè¿™æ—¶å€™ä½ é¡¹ç›®æ ¹ç›®å½•ä¸‹æœ‰ä¸€ä¸ª public æ–‡ä»¶å¤¹ï¼Œæ–‡ä»¶å¤¹é‡Œæœ‰ä¸€ä¸ª hello.txt æ–‡ä»¶ï¼Œé‚£ä¹ˆä½ å°±å¯ä»¥é€šè¿‡ http://localhost:8091/hello.txt æ¥è®¿é—®è¿™ä¸ªæ–‡ä»¶äº†ã€‚

å¦‚æœä½ æœ‰å¤šä¸ªæ–‡ä»¶å¤¹éœ€è¦æŒ‡å®šï¼Œä¹Ÿå¯ä»¥é…ç½®æˆæ•°ç»„ï¼š


```js
devServer: {
  contentBase: [path.join(__dirname, 'public'), path.join(__dirname, 'assets')]
}
```

### contentBasePublicPath ğŸ”‘

**è¿™æ˜¯ webpack V5 æ–°å¢çš„ç‰¹æ€§ã€‚** å®ƒç»™ä½ çš„ contentBase é‡Œé¢æœåŠ¡çš„å†…å®¹åŠ ä¸Šè®¿é—®å‰ç¼€ã€‚æ¯”å¦‚ï¼š

```js
devServer: {
  contentBase: path.join(__dirname, 'public'),
  contentBasePublicPath: '/ppp'
}
```

ä½ åœ¨æµè§ˆå™¨çš„è®¿é—®è·¯å¾„å‰é¢å°±è¦åŠ ä¸Š ppp å‰ç¼€ï¼šhttp://localhost:8091/ppp/hello.txtã€‚å¦‚æœä½  contentBase é…ç½®çš„æ˜¯æ•°ç»„ï¼Œé‚£ä¹ˆä½ è¿™ä¸ªä¹Ÿè¦é…ç½®æˆå¯¹åº”çš„æ•°ç»„ã€‚

```js
devServer: {
  contentBase: [path.join(__dirname, 'public'), path.join(__dirname, 'assets')],
  contentBasePublicPath: ['/public', '/assets']
}
```

### watchContentBase

å‘Šè¯‰ dev-server å»ç›‘å¬ devServer.contentBase è·¯å¾„ä¸‹çš„æ–‡ä»¶ã€‚å¦‚æœè®¾ç½®ä¸ºå®ƒ true çš„è¯ï¼Œé‚£ä¹ˆè¯¥ç›®å½•ä¸‹ä»»æ„æ–‡ä»¶çš„ä¿®æ”¹éƒ½ä¼šå‡ºå‘é¡µé¢çš„åˆ·æ–°ã€‚

```js
devServer: {
  contentBase: path.join(__dirname, 'public'),
  watchContentBase: true
}
```

ï¼ˆæˆ‘ç»“åˆä¸Šé¢çš„ hello.txt è¯•äº†ï¼Œæˆ‘ä¿®æ”¹ hello.txt æ–‡ä»¶åï¼Œé¡µé¢å¹¶æ²¡æœ‰åˆ·æ–°ã€‚ä¸çŸ¥é“æ˜¯å“ªé‡Œå‡ºäº†é—®é¢˜ï¼Œå¾…ç ”ç©¶ã€‚ï¼‰

### watchOptions

æ–‡ä»¶ç›‘å¬ç›¸å…³çš„æ§åˆ¶ã€‚å¯ä»¥å‚è€ƒ watchOptions ç« èŠ‚ï¼Œä»–ä»¬çš„é…ç½®æ˜¯ä¸€æ ·çš„ã€‚

### headers

ç»™æ‰€æœ‰çš„å“åº”æ·»åŠ å“åº”å¤´ã€‚

```js
devServer: {
  headers: {
    'X-header': 'This is custom header'
  }
}
```

ç»“æœï¼š

![headers](../images/headers.png)

### liveReload

æ§åˆ¶æµè§ˆå™¨æ˜¯å¦å®æ—¶åˆ·æ–°ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå½“ç›‘æµ‹åˆ°æ–‡ä»¶æ”¹å˜æ—¶ï¼Œdev-server ä¼šåˆ·æ–°é¡µé¢ã€‚è¦æƒ³ liveReload ç”Ÿæ•ˆçš„è¯ï¼ŒdevServer.hot è¦ä¸º falseï¼Œæˆ–è€… devServer.watchContentBase ä¸º trueã€‚

```js
devServer: {
  liveReload: false
}
```

### socket ç›¸å…³

è¿™ä¸ªæˆ‘ä»¬å‡ ä¹å¾ˆå°‘å»é…ç½®ï¼Œåšä¸€ä¸ªäº†è§£å³å¯ã€‚

```js
devServer: {
  socket: 'socket', // è¦ç›‘å¬çš„ Unix socket
  sockHost: 'mysocket.test', // å‘Šè¯‰è¿æ¥åˆ° devServer çš„å®¢æˆ·ç«¯ä½¿ç”¨æä¾›çš„ socket ä¸»æœº
  sockPath: '/mysocket', // è®¿é—® socket çš„è·¯å¾„
  sockPort: 8080 // å‘Šè¯‰å®¢æˆ·ç«¯ä½¿ç”¨è¿™ä¸ªç«¯å£å»è¿æ¥ devServer
}
```

### historyApiFallback ğŸ”‘

å½“ä½¿ç”¨ HTML5 History API çš„æ—¶å€™ï¼Œindex.html è¿˜è¦æ‰¿è½½ç€ 404 çš„è¯·æ±‚ã€‚é€šè¿‡è®¾ç½®è¿™ä¸ªå±æ€§ä¸º true å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼š

```js
devServer: {
  historyApiFallback: true
}
```

è¿™æ—¶å€™ï¼Œä½ è®¿é—®ä¸€ä¸ªä¸å­˜åœ¨çš„è·¯å¾„ï¼Œä¹Ÿä¼šå»è¯·æ±‚ index.html æ–‡ä»¶çš„å†…å®¹ã€‚

è¿™ä¸ªå±æ€§è¿˜æ”¯æŒæ›´é«˜çº§çš„é…ç½®ï¼š

```js
devServer: {
  historyApiFallback: {
    rewrites: [
      { from: /^\/$/, to: '/views/landing.html' },
      { from: /^\/subpage/, to: '/views/subpage.html' },
      { from: /./, to: '/views/404.html' }
    ]
  }
}
```

æœ‰å…´è¶£çš„è¯å¯ä»¥è‡ªå·±å°è¯•ä¸€ä¸‹ã€‚

### proxy ğŸ”‘

æƒ³å¿…è¿™ä¸ªå±æ€§å¤§å®¶éƒ½å¾ˆç†Ÿæ‚‰ï¼Œå¼€å‘è¿‡ç¨‹ä¸­ç»å¸¸ä¼šéœ€è¦é…ç½®å®ƒæ¥å®ç°è·¨åŸŸã€‚è¯¦ç»†çš„é…ç½®å¯ä»¥å‚è€ƒ [http-proxy-middleware](https://github.com/chimurai/http-proxy-middleware#options) è¿™ä¸ªåŒ…ï¼Œè¿™é‡Œæˆ‘ä»¬ä»‹ç»å¸¸è§çš„å‡ ç§ã€‚

å½“ä½ çš„åç«¯éƒ¨ç½²åœ¨ 35.123.18.192 ä¸Šçš„æ—¶å€™ï¼Œä½ å¯ä»¥è¿™ä¹ˆé…ç½®ï¼š

```js
devServer: {
  proxy: {
    '/api': 'http://35.123.18.192'
  }
}
```

è¿™æ—¶å€™ï¼Œå¦‚æœåœ¨ä»£ç ä¸­è¯·æ±‚ /api/users ï¼Œè¿™ä¸ªè¯·æ±‚ä¼šè¢«ä»£ç†å‘é€åˆ° http://35.123.18.192/api/usersã€‚

å½“ä½ ä¸æƒ³è¦å‘é€ /api è¿™ä¸ªå‰ç¼€çš„æ—¶å€™ï¼Œä½ å¯ä»¥ä½¿ç”¨ pathRewrite æ¥æ”¹æ‰å®ƒï¼Œè¿™æ—¶å€™è¦å°†è·¯å¾„å¯¹åº”çš„å€¼è®¾ç½®æˆå¯¹è±¡ï¼š

```js
devServer: {
  proxy: {
    '/api': {
        target: 'http://35.123.18.192',
        pathRewrite: {
          '^/api': ''
        }
    }
  }
}
```

è¿™é‡Œé…ç½®çš„ pathRewrite è¡¨ç¤ºï¼Œå¦‚æœä¸€ä¸ªè¯·æ±‚è·¯å¾„ä»¥ /api å¼€å¤´ï¼Œç»Ÿä¸€çš„å°† /api å»æ‰ï¼Œä¹Ÿå°±æ˜¯è¯´ `axios.get('/api/users/')` å®é™…ä¸Šä¼šå‘é€ï¼š`http://35.123.18.192/users` è¿™ä¸ªè¯·æ±‚ã€‚ä½ ä¹Ÿå¯ä»¥é€šè¿‡è¿™ä¸ª pathRewrite åšä¸€äº›æœ‰æ„æ€çš„äº‹ï¼Œæ¯”å¦‚è¿™ä¸ªåœºæ™¯ï¼šåç«¯æŸä¸ªæ¥å£æ²¡å†™å®Œï¼Œå®ƒè¦ç»™ä½ ä¸€ä¸ª mock æ¥å£ï¼Œä½ å°±å¯ä»¥åœ¨è¿™é‡Œé…ç½®é‡å†™è§„åˆ™äº†ï¼Œæ¯”å¦‚ï¼š

```js
pathRewrite: {
  '/users': '/fake-users'
}
```


å¦‚æœä½ æƒ³ä»£ç†å¤šä¸ªè·¯å¾„åˆ°åŒä¸€ä¸ªç›®æ ‡æœåŠ¡å™¨ä¸Šï¼Œä½ è¿˜å¯ä»¥ä½¿ç”¨ context å±æ€§æ¥é…ç½®ï¼š

```js
devServer: {
  proxy: [{
    context: ['/auth', '/api'],
    target: 'http://localhost:3000',
  }, {
    context: ['/v2/auth', '/v2/api'],
    target: 'http://localhost:4000',
  }]
}
```

é»˜è®¤æƒ…å†µä¸‹ï¼Œä½¿ç”¨æ— æ•ˆè¯ä¹¦è¿è¡Œåœ¨HTTPSä¸Šçš„åç«¯æœåŠ¡å™¨å°†ä¸è¢«æ¥å—ã€‚å¦‚æœéœ€è¦ï¼Œå¯ä»¥åƒè¿™æ ·ä¿®æ”¹é…ç½®ï¼š

```js
devServer: {
  proxy: {
    '/api': {
      target: 'https://xxx.com',
      secure: false
    }
  }
}
```

å¦‚æœä½ æƒ³é€‰æ‹©æ€§çš„ä»£ç†ä¸€äº›è¯·æ±‚ï¼Œæ¯”å¦‚é’ˆå¯¹ API è¯·æ±‚èµ°ä»£ç†ï¼Œé’ˆå¯¹ html é¡µé¢è¯·æ±‚ä¸èµ°ä»£ç†ï¼Œä½ å¯ä»¥ä½¿ç”¨ bypass æ¥æ§åˆ¶è¿™ç§è¡Œä¸ºï¼š

```js
devServer: {
  bypass(req, res, proxy) {
    if (req.url.indexOf('html') !== -1) {
      console.log('Skipping proxy for browser request.');
      return '/index.html';
    }
  }
}
```

bypass æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒçš„è§„åˆ™æ˜¯è¿™æ ·çš„ï¼š

- å¦‚æœè¿”å› null æˆ–è€… undefinedï¼Œä½¿ç”¨ä»£ç†æ¥å¤„ç†è¯·æ±‚ï¼›
- å¦‚æœè¿”å› falseï¼Œé‚£ä¹ˆè¿™ä¸ªè¯·æ±‚ç»“æœä¸º 404
- è¿”å›ä¸€ä¸ªè·¯å¾„ï¼Œå°±å»è¯·æ±‚è¿™ä¸ªè·¯å¾„çš„èµ„æºï¼Œä¸èµ°ä»£ç†

é»˜è®¤æƒ…å†µä¸‹ï¼ŒåŸå§‹çš„ Host å¤´æ˜¯è¢«ä¸€ç›´ä¿ç•™çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä»£ç†è¿‡å»çš„è¯·æ±‚å¤´ä¸­çš„ Host çš„å€¼æ˜¯æœ€åŸå§‹çš„ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œæˆ‘é…ç½®äº† proxy è®¿é—® 35.123.23.24 æœåŠ¡å™¨ã€‚åº”ç”¨åœ¨æœ¬åœ°è¿è¡Œåï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼ŒdevServer å‘é€åˆ°è¿œç¨‹æœåŠ¡å™¨çš„è¯·æ±‚å¤´çš„ Host å­—æ®µï¼Œæ˜¯ localhostï¼Œä½†æ˜¯è¿™ä¸ªå¯¹äºè¿œç«¯æœåŠ¡å™¨æ¥è¯´ï¼Œå¯èƒ½ä¼šè¢«æ‹’ç»ã€‚æ‰€ä»¥æœ‰çš„æƒ…å†µä¸‹ï¼Œä½ å¯ä»¥å°† changeOrigin è®¾ç½®ä¸º true æ¥ä¿®æ”¹è¿™ç§é»˜è®¤è¡Œä¸ºã€‚

```js
devServer: {
  proxy: {
    '/api': {
      target: 'http://35.123.23.23',
      changeOrigin: true
    }
  }
}
```